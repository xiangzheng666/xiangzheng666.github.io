---
categories: [redis]
tags: [redis]
---
# Redis简单动态字符串SDS

Redis 没有直接使用 C 语言传统的字符串表示（以空字符结尾的字符数组，以下简称 C 字符串）， 而是自己构建了一种名为简单动态字符串（simple dynamic string，SDS）的抽象类型， 并将 SDS 用作 Redis 的默认字符串表示。

```c
struct sdshdr {    // 记录 buf 数组中已使用字节的数量
    // 等于 SDS 所保存字符串的长度
    int len;    // 记录 buf 数组中未使用字节的数量
    intfree;    // 字节数组，用于保存字符串
    char buf[];
};
```

## 数据结构特点

- 1.常数复杂度获取字符串长度
- 2.杜绝缓冲区溢出：当 SDS API 需要对 SDS 进行修改时， API 会先检查 SDS 的空间是否满足修改所需的要求， 如果不满足的话， API 会自动将 SDS 的空间扩展至执行修改所需的大小， 然后才执行实际的修改操作
- 3.空间预分配
- 4.惰性空间释放
- 5.可以保存'\0'，使用len计算结尾位置
-
